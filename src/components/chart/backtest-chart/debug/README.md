# 指标调试面板

## 概述

指标调试面板是一个开发环境下的调试工具，用于帮助开发者调试和管理回测图表中的指标。

## 功能特性

### 1. 图表信息显示
- 显示图表ID
- 显示主图指标数量
- 显示子图数量
- 显示Pane数量（如果图表API可用）

### 2. 指标管理
- **查看所有指标**: 列出所有主图和子图指标
- **指标可见性控制**: 单独控制每个指标的显示/隐藏
- **批量操作**: 
  - 全部显示
  - 全部隐藏
  - 删除全部指标
- **指标删除**: 单独删除指标，自动处理子图Pane的清理

### 3. 数据统计
- 显示每个指标的数据点数量
- 区分主图指标和子图指标
- 显示指标是否有数据

### 4. 调试功能
- **打印图表配置**: 将完整的图表配置打印到控制台，并复制到剪贴板
- **打印指标详情**: 查看单个指标的详细信息，包括数据统计

## 使用方法

### 启用调试面板
调试面板只在开发环境下显示：
```tsx
{process.env.NODE_ENV === 'development' && (
  <IndicatorDebugPanel
    chartConfig={chartConfig}
    chartApiRef={chartApiRef}
  />
)}
```

### 打开调试面板
1. 在图表右上角点击"调试面板"按钮
2. 调试面板将以浮动窗口的形式显示

### 主要操作

#### 查看图表配置
1. 点击"打印配置到控制台"按钮
2. 打开浏览器开发者工具的控制台
3. 查看详细的配置信息
4. 配置会自动复制到剪贴板

#### 管理指标
1. **查看指标详情**: 点击绿色的信息按钮(i)
2. **切换可见性**: 点击眼睛图标
3. **删除指标**: 点击红色的垃圾桶图标
4. **批量操作**: 使用底部的批量操作按钮

#### 指标信息说明
- **指标名称**: 显示指标的名称
- **类型标签**: 
  - "主图" - 主图指标
  - "子图N" - 第N个子图的指标
- **数据标签**: 显示数据点数量，如"120 条数据"
- **指标键**: 显示完整的指标键字符串

## 控制台输出格式

### 图表配置输出
```
🔧 图表配置调试信息
  📊 完整配置: {...}
  🔑 图表ID: 1
  📈 K线配置: {...}
  📊 主图指标配置: {...}
  📉 子图配置: [...]
  📋 指标数据: {...}
  📊 子图1: {...}
  🎯 图表API信息:
    - Panes数量: 3
    - 时间范围: {...}
    - 图表尺寸: {...}
```

### 指标详情输出
```
🔍 指标详情: MA20
  指标键: symbol:BTCUSDT|interval:1m|indicator:MA|params:{"period":20}
  指标类型: main
  可见性: true
  数据详情: {...}
  数据点数量: 120
    value: 120 个数据点
```

## 注意事项

1. **仅开发环境**: 调试面板只在 `NODE_ENV === 'development'` 时显示
2. **性能影响**: 调试面板会监听store状态变化，在生产环境中会被自动移除
3. **数据安全**: 打印的配置信息可能包含敏感数据，请注意控制台的访问权限
4. **浏览器兼容性**: 剪贴板功能需要现代浏览器支持

## 开发建议

1. 在添加新指标时，使用调试面板验证配置是否正确
2. 在调试指标显示问题时，检查数据统计和可见性状态
3. 在优化性能时，观察数据点数量和更新频率
4. 在处理复杂图表布局时，使用Pane信息进行调试
